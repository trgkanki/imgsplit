(function(t){function e(e){for(var n,c,o=e[0],s=e[1],u=e[2],f=0,d=[];f<o.length;f++)c=o[f],Object.prototype.hasOwnProperty.call(r,c)&&r[c]&&d.push(r[c][0]),r[c]=0;for(n in s)Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n]);h&&h(e);while(d.length)d.shift()();return i.push.apply(i,u||[]),a()}function a(){for(var t,e=0;e<i.length;e++){for(var a=i[e],n=!0,o=1;o<a.length;o++){var s=a[o];0!==r[s]&&(n=!1)}n&&(i.splice(e--,1),t=c(c.s=a[0]))}return t}var n={},r={app:0},i=[];function c(e){if(n[e])return n[e].exports;var a=n[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,c),a.l=!0,a.exports}c.m=t,c.c=n,c.d=function(t,e,a){c.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},c.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},c.t=function(t,e){if(1&e&&(t=c(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(c.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)c.d(a,n,function(e){return t[e]}.bind(null,n));return a},c.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return c.d(e,"a",e),e},c.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},c.p="";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],s=o.push.bind(o);o.push=e,o=o.slice();for(var u=0;u<o.length;u++)e(o[u]);var h=s;i.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("cd49")},1:function(t,e){},2:function(t,e){},"5c0b":function(t,e,a){"use strict";var n=a("9c0c"),r=a.n(n);r.a},"751a":function(t,e,a){"use strict";a.d(e,"a",(function(){return n}));a("99af"),a("d3b7");function n(t){for(var e=arguments.length,a=new Array(e>1?e-1:0),n=1;n<e;n++)a[n-1]=arguments[n];return new Promise((function(e,n){var r="pyfunc:".concat(t,":").concat(JSON.stringify(a));pycmd(r,(function(t){var a=t.error;return a?n(new Error(a)):e(t.payload)}))}))}},"78c7":function(t,e,a){"use strict";(function(t){a("c975"),a("d81d"),a("a434"),a("d3b7"),a("3ca3"),a("ddb0");var n=a("b85c"),r=(a("96cf"),a("1da1")),i=a("d4ec"),c=a("bee2"),o=a("262e"),s=a("2caf"),u=a("9ab4"),h=a("60a3"),f=a("7e37"),d=a.n(f),l=a("7dda"),p=a("751a"),b=a("d4b1"),v=function(e){Object(o["a"])(u,e);var a=Object(s["a"])(u);function u(){var t;return Object(i["a"])(this,u),t=a.apply(this,arguments),t.separatorList=[],t.image=null,t}return Object(c["a"])(u,[{key:"mounted",value:function(){var e=this;setTimeout(Object(r["a"])(regeneratorRuntime.mark((function a(){var n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(-1===navigator.userAgent.indexOf("QtWebEngine")){a.next=12;break}return a.next=3,Object(p["a"])("imgsplit_getCurrentImage");case 3:return n=a.sent,r=t.from(n,"base64"),a.t0=e,a.next=8,d.a.read(r);case 8:a.t1=a.sent,a.t0.setImage.call(a.t0,a.t1),a.next=17;break;case 12:return a.t2=e,a.next=15,d.a.read("/p1.png");case 15:a.t3=a.sent,a.t2.setImage.call(a.t2,a.t3);case 17:case"end":return a.stop()}}),a)}))),100)}},{key:"onSubmit",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){var e,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(0===this.separatorList.length&&this.onCancel(),this.image){t.next=3;break}return t.abrupt("return");case 3:return e=Object(b["a"])(this.image,this.separatorList),t.next=6,Promise.all(e.map((function(t){return t.getBase64Async("image/png")})));case 6:return a=t.sent,t.next=9,Object(p["a"])("imgsplit_retSplitImage",a);case 9:window.close();case 10:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"onCancel",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(p["a"])("imgsplit_retSplitImage",null);case 2:window.close();case 3:case"end":return t.stop()}}),t)})));function e(){return t.apply(this,arguments)}return e}()},{key:"setImage",value:function(t){this.image=t;var e=Object(l["a"])(t),a=this.$refs.imgCanvas,n=this.$refs.separatorCanvas;a.width=e.width,a.height=e.height,a.getContext("2d").putImageData(e,0,0),n.width=e.width,n.height=e.height,this.separatorList=[]}},{key:"toggleSeparator",value:function(t){for(var e=this.separatorList,a=t.offsetY/t.target.offsetHeight*t.target.height|0,n=0;n<e.length;n++){var r=e[n];if(Math.abs(r-a)<10)return void e.splice(n,1)}e.push(a)}},{key:"onSeperatorChanged",value:function(t){var e=this.$refs.separatorCanvas,a=e.getContext("2d");a.clearRect(0,0,e.width,e.height);var r,i=Object(n["a"])(t);try{for(i.s();!(r=i.n()).done;){var c=r.value;a.beginPath(),a.moveTo(0,c),a.lineTo(e.width,c),a.stroke()}}catch(o){i.e(o)}finally{i.f()}}}]),u}(h["b"]);Object(u["a"])([Object(h["c"])("separatorList")],v.prototype,"onSeperatorChanged",null),v=Object(u["a"])([h["a"]],v),e["a"]=v}).call(this,a("b639").Buffer)},"7dda":function(t,e,a){"use strict";a.d(e,"a",(function(){return n}));a("d3b7"),a("8a59"),a("9a8c"),a("a975"),a("735e"),a("c1ac"),a("d139"),a("3a7b"),a("d5d6"),a("82f8"),a("e91f"),a("60bd"),a("5f96"),a("3280"),a("3fcc"),a("ca91"),a("25a1"),a("cd26"),a("3c5d"),a("2954"),a("649e"),a("219c"),a("170b"),a("b39a"),a("72f7");function n(t){return new ImageData(new Uint8ClampedArray(t.bitmap.data),t.bitmap.width,t.bitmap.height)}},"9c0c":function(t,e,a){},cd49:function(t,e,a){"use strict";a.r(e);a("e260"),a("e6cf"),a("cca6"),a("a79d");var n=a("2b0e"),r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},[a("div",{staticClass:"canvas-container"},[a("canvas",{ref:"separatorCanvas",staticClass:"downscale overlay",on:{click:t.toggleSeparator}}),a("canvas",{ref:"imgCanvas",staticClass:"downscale"})]),a("div",{staticClass:"button-container"},[a("button",{on:{click:t.onSubmit}},[t._v("OK")]),a("button",{on:{click:t.onCancel}},[t._v("Cancel")])])])},i=[],c=a("78c7"),o=c["a"],s=(a("5c0b"),a("2877")),u=Object(s["a"])(o,r,i,!1,null,null,null),h=u.exports;n["a"].config.productionTip=!1,new n["a"]({render:function(t){return t(h)}}).$mount("#app")},d4b1:function(t,e,a){"use strict";a.d(e,"a",(function(){return h}));a("fb6a");var n=a("b85c"),r=a("d4ec"),i=a("bee2"),c=a("ef21"),o=a.n(c),s=function(){function t(e,a){Object(r["a"])(this,t),this.img=e,this.data=e.bitmap.data,this.pitch=4*e.bitmap.width,a?(this.x0=a.x,this.y0=a.y,this.w=a.w,this.h=a.h):(this.x0=0,this.y0=0,this.w=e.bitmap.width,this.h=e.bitmap.height)}return Object(i["a"])(t,[{key:"dataIndex",value:function(t,e){return 4*(t+this.x0)+(e+this.y0)*this.pitch}},{key:"u32col",value:function(t,e){return this.data.readUInt32BE(this.dataIndex(t,e))}},{key:"crop",value:function(e,a,n,r){return n<0&&(n=0),r<0&&(r=0),new t(this.img,{x:this.x0+e,y:this.y0+a,w:n,h:r})}},{key:"autocrop",value:function(){var t=this.data,e=this.pitch,a=this.w,n=this.h,r=0;while(r<n){for(var i=!1,c=this.dataIndex(a,r),o=this.dataIndex(0,r);o<c;o+=4)if(4294967295!==t.readUInt32BE(o)){i=!0;break}if(i)break;r++}var s=n-1;while(s>=0){for(var u=!1,h=this.dataIndex(a,s),f=this.dataIndex(0,s);f<h;f+=4)if(4294967295!==t.readUInt32BE(f)){u=!0;break}if(u)break;s--}s<r&&(s=r-1);var d=0;while(d<a){for(var l=!1,p=this.dataIndex(d,n),b=this.dataIndex(d,0);b<p;b+=e)if(4294967295!==t.readUInt32BE(b)){l=!0;break}if(l)break;d++}var v=a-1;while(v>=0){for(var g=!1,m=this.dataIndex(v,n),w=this.dataIndex(v,0);w<m;w+=e)if(4294967295!==t.readUInt32BE(w)){g=!0;break}if(g)break;v--}return v<d&&(v=d-1),this.crop(d,r,v-d+1,s-r+1)}},{key:"toJimp",value:function(){return this.toJimpWithPad(0)}},{key:"toJimpWithPad",value:function(t){for(var e=new o.a(this.w+2*t,this.h+2*t,4294967295),a=e.bitmap.data,n=this.data,r=this.w,i=this.h,c=this.pitch,s=4*(this.w+2*t),u=this.dataIndex(0,0),h=4*t+t*s,f=4*r,d=0;d<i;d++)n.copy(a,h,u,u+f),u+=c,h+=s;return e}}]),t}(),u=s;function h(t,e){var a=0,r=[],i=t.bitmap,c=i.width,o=i.height,s=new u(t);e=e.slice().sort();var h,f=Object(n["a"])(e);try{for(f.s();!(h=f.n()).done;){var d=h.value;d!==a&&r.push(s.crop(0,a,c,d-a).autocrop().toJimpWithPad(20)),a=d}}catch(l){f.e(l)}finally{f.f()}return o!==a&&r.push(s.crop(0,a,c,o-a).autocrop().toJimpWithPad(20)),r}}});
//# sourceMappingURL=app.4f3e7b28.js.map